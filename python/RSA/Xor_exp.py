from Crypto.PublicKey import RSA
from Crypto.Cipher import PKCS1_OAEP
from Crypto.Cipher import PKCS1_v1_5
import gmpy2
import libnum
import base64

def decrypt():
    p = int('''
        157194667273395078091690715359649373226005247729684564897233925620451263163534476559233007477874770144949074471296577678270820453203784261690001421933906316488224081275610737920296334697466445787310072301759253431687655435272535953996103257268055911344285357880348486067423090573148921357811044304231614285373
    ''')
    q = int('''
        120704675500260151469966649988822073439735620657157178605185111090847776896412605616399851623640833537748026036394147889121948427362807952170087685331046616222708535122650963466159965155206404582900022412695010039292107108659626384086949151937712914513006713261769248399597038840377613425426477030974588859983
    ''')
    e = 65537
    n = int('''
        18974131303606517108116779221394983351107953418674246808002046468756695163654887691911576186421805200250724321568280195905290442205232517227748969364090141063128939314878515317496341421052786397637775756920934374402845581351369492477771453093640094024467419280993344938852728756640716156565675517813218333062731827741326761259969868455874961692512448497903630657495966824453734032513674207164780712696722182628908402340122033085935890252243199482816629275286868697072041774808266299597266915191885557647884902011866719857934046712299602699100891310652940496655959481394816839239749563560927325844243871359449301928659
    ''')

    phi = (p-1)*(q-1)
    d = int(gmpy2.invert(e, phi))
    key_info = RSA.construct((n, e, d, p, q))
    key = RSA.importKey(key_info.exportKey())
    key = PKCS1_OAEP.new(key)
    # key = PKCS1_v1_5.new(key)
    fp = '/tmp/flag.enc'
    with open(fp, "rb") as f:
        c = f.read()
        print(int.from_bytes(c, "little"))
    # PKCS1_OAEP
    m = key.decrypt(c)

    # PKCS1_v1_5
    # m = key.decrypt(c, None)
    print(m)

decrypt()