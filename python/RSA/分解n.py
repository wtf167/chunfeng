#!/usr/bin/python3
# -*- coding:UTF-8 -*-
import gmpy2
import sympy.crypto.crypto


def foo(n):
    x = gmpy2.iroot(n, 2)[0]
    p = sympy.crypto.crypto.nextprime(x)
    q = n // p
    return p, q


def isqrt(n):
    x = n
    y = (x + n // x) // 2
    while y < x:
        x = y
        y = (x + n // x) // 2
    return x


def fermat(n):
    a = isqrt(n)
    b2 = a * a - n
    b = isqrt(b2)
    count = 0
    while b * b != b2:
        a = a + 1
        b2 = a * a - n
        b = isqrt(b2)
        count += 1
    p = a + b
    q = a - b
    assert n == p * q
    return p, q


n = int('''
49025724928152491719950645039355675823887062840095001672970308684156817293484070166684235178364916522473822184239221170514602692903302575847326054102901449806271709230774063675539139201327878971370342483682454617270705142999317092151456200639975738970405158598235961567646064089356496022247689989925574384915789399433283855087561428970245448888799812611301566886173165074558800757040196846800189738355799057422298556992606146766063202605288257843684190291545600282197788724944382475099313284546776350595539129553760118549158103804149179701853798084612143809757187033897573787135477889183344944579834942896249251191453
''')
p, q = fermat(n)
print("p = {}\nq = {}".format(p, q))
